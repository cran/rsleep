<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Spindles detection and analysis</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Spindles detection and analysis</h1>


<div id="TOC">
<ul>
<li><a href="#sleep-data" id="toc-sleep-data">Sleep data</a>
<ul>
<li><a href="#eeg-signal" id="toc-eeg-signal">EEG signal</a></li>
<li><a href="#scored-events" id="toc-scored-events">Scored
events</a></li>
</ul></li>
<li><a href="#spindle-detection-using-a7" id="toc-spindle-detection-using-a7">Spindle detection using A7</a></li>
<li><a href="#overnight-spindle-detection" id="toc-overnight-spindle-detection">Overnight spindle
detection</a></li>
</ul>
</div>

<p>Sleep spindles are distinct bursts of brain activity that occur
mostly during stage 2 of non-rapid eye movement (NREM) sleep.
Characterized by their short duration, typically lasting between 0.5 to
2 seconds, they appear as a rapid series of waves on an
electroencephalogram (EEG). These waves are typically in the 11 to 16 Hz
frequency range <span class="citation">[1]</span> . Sleep spindles are
thought to play a crucial role in brain development, memory
consolidation, and cognitive function. Their presence and
characteristics can vary depending on age, cognitive factors, and
certain neurological conditions, making them a significant focus in
sleep research and neuroscience.</p>
<p>While EEG-based visual inspection remains the benchmark for
identifying these spindles, this process is not only labor-intensive and
expensive but also prone to variability and bias among different
scorers. An algorithm for sleep spindle detection significantly
streamline this process, enhancing both efficiency and consistency in
spindle identification.</p>
<p>The A7 algorithm <span class="citation">[2]</span> operates using a
single EEG channel and is dependent on four objective key parameters:
the absolute power of the sigma band, its relative power, and the
correlation or covariance between the sigma band-passed signal and the
original EEG signal.</p>
<div id="sleep-data" class="section level1">
<h1>Sleep data</h1>
<div id="eeg-signal" class="section level2">
<h2>EEG signal</h2>
<p>First, download and read an single EEG signal from an example EDF
<span class="citation">[3]</span> file. According to the standardized
10-20 system <span class="citation">[4]</span>, the <code>C3-M2</code>
derivation refers to the measurement of electrical brain activity
recorded between the C3 electrode position on the left side of the head
and the M2 electrode positioned on the right mastoid.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(edfReader)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">download.file</span>(</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="at">url =</span> <span class="st">&quot;https://rsleep.org/data/15012016HD.edf&quot;</span>,</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  <span class="at">destfile =</span> <span class="st">&quot;15012016HD.edf&quot;</span>)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">readEdfHeader</span>(<span class="st">&quot;15012016HD.edf&quot;</span>)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">readEdfSignals</span>(h, <span class="at">signals =</span> <span class="st">&quot;C3-M2&quot;</span>)</span></code></pre></div>
<pre><code>#&gt; [1] TRUE</code></pre>
</div>
<div id="scored-events" class="section level2">
<h2>Scored events</h2>
<p>Then, download and read the scored events containing the hypnogram
data to epoch the signal and focus the analysis on N2 epochs.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">download.file</span>(</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="at">url =</span> <span class="st">&quot;https://rsleep.org/data/15012016HD.csv&quot;</span>,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="at">destfile =</span> <span class="st">&quot;15012016HD.csv&quot;</span>)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>events <span class="ot">&lt;-</span> rsleep<span class="sc">::</span><span class="fu">read_events_noxturnal</span>(<span class="st">&quot;15012016HD.csv&quot;</span>)</span></code></pre></div>
<pre><code>#&gt; [1] TRUE</code></pre>
<p>The hypnogram can be plotted using <code>plot_hypnogram()</code>
function from rsleep.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">plot_hypnogram</span>(events)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="spindle-detection-using-a7" class="section level1">
<h1>Spindle detection using A7</h1>
<p>Select the 10th N2 epoch that we know contain spindles.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>n2_epoch <span class="ot">=</span> events[events<span class="sc">$</span>event <span class="sc">==</span> <span class="st">&quot;N2&quot;</span>,][<span class="dv">10</span>,]</span></code></pre></div>
<p>Compute the epoch boundaries in the signal: subtract the epoch times
from the signal start time, then multiply by the signal’s sample rate.
Add one to the start result to adjust for R’s indexing system.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>n2_epoch_index_start <span class="ot">=</span> <span class="fu">as.numeric</span>(</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="fu">difftime</span>(n2_epoch<span class="sc">$</span>begin, s<span class="sc">$</span>startTime, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>)) <span class="sc">*</span> s<span class="sc">$</span>sRate <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>n2_epoch_index_end <span class="ot">=</span> <span class="fu">as.numeric</span>(</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  <span class="fu">difftime</span>(n2_epoch<span class="sc">$</span>end, s<span class="sc">$</span>startTime, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>)) <span class="sc">*</span> s<span class="sc">$</span>sRate</span></code></pre></div>
<p>Get the signal and multiply it as the A7 algorithm was designed for
uVolts and the current EEG record is in Volts.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>eeg <span class="ot">=</span> s<span class="sc">$</span>signal[n2_epoch_index_start<span class="sc">:</span>n2_epoch_index_end]</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>eeg <span class="ot">=</span> eeg <span class="sc">*</span> <span class="dv">1000000</span></span></code></pre></div>
<p>Run the A7 algorithm implemented in <code>rsleep</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">a7</span>(</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="at">x =</span> eeg,</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  s<span class="sc">$</span>sRate)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>  </span></code></pre></div>
<p>Display the 3 first detected spindles properties.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>result<span class="sc">$</span>spindles[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,]</span></code></pre></div>
<p>Visualise the second detected spindle with <code>ggplot2</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x=</span>eeg,<span class="at">index=</span><span class="fu">seq_along</span>(eeg))</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>a <span class="ot">=</span> result<span class="sc">$</span>spindles<span class="sc">$</span>idxStart[<span class="dv">2</span>]</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>b <span class="ot">=</span> result<span class="sc">$</span>spindles<span class="sc">$</span>idxEnd[<span class="dv">2</span>]</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>data <span class="ot">=</span> data[(data<span class="sc">$</span>index <span class="sc">&lt;=</span> (b<span class="sc">+</span><span class="dv">600</span>)) <span class="sc">&amp;</span> (data<span class="sc">$</span>index <span class="sc">&gt;=</span> (a<span class="dv">-600</span>)), ]</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> index, <span class="at">y =</span> x)) <span class="sc">+</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">subset</span>(data, index <span class="sc">&gt;=</span> a <span class="sc">&amp;</span> index <span class="sc">&lt;=</span> b), <span class="fu">aes</span>(<span class="at">x =</span> index, <span class="at">y =</span> x), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Signal index&quot;</span>, <span class="at">y =</span> <span class="st">&quot;C3-M2&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="overnight-spindle-detection" class="section level1">
<h1>Overnight spindle detection</h1>
<p>Joining the previous steps in a for loop along all N2 epochs,
spindles are detected over the whole sleep record:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>n2_epochs <span class="ot">=</span> events[events<span class="sc">$</span>event <span class="sc">==</span> <span class="st">&quot;N2&quot;</span>,]</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>epochs_results <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(n2_epochs))){</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>  </span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>  n2_epoch_index_start <span class="ot">=</span> <span class="fu">as.numeric</span>(</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>    <span class="fu">difftime</span>(n2_epochs<span class="sc">$</span>begin[i],s<span class="sc">$</span>startTime,<span class="at">units =</span> <span class="st">&quot;secs&quot;</span>)) <span class="sc">*</span> s<span class="sc">$</span>sRate <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>  n2_epoch_index_end <span class="ot">=</span> <span class="fu">as.numeric</span>(</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>    <span class="fu">difftime</span>(n2_epochs<span class="sc">$</span>end[i],s<span class="sc">$</span>startTime,<span class="at">units =</span> <span class="st">&quot;secs&quot;</span>)) <span class="sc">*</span> s<span class="sc">$</span>sRate</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>  eeg <span class="ot">=</span> s<span class="sc">$</span>signal[n2_epoch_index_start<span class="sc">:</span>n2_epoch_index_end]</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>  eeg <span class="ot">=</span> eeg <span class="sc">*</span> <span class="dv">1000000</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>  </span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>  results <span class="ot">=</span> rsleep<span class="sc">::</span><span class="fu">a7</span>(</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>    <span class="at">x =</span> eeg,</span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>    s<span class="sc">$</span>sRate)</span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>  </span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>  epochs_results[[<span class="fu">length</span>(epochs_results)<span class="sc">+</span><span class="dv">1</span>]] <span class="ot">=</span> results</span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>  </span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>}</span></code></pre></div>
<p>Detected spindles from all the epochs may be bound together using
<code>bind_rows()</code> from <code>dplyr</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>spindles <span class="ot">=</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="fu">lapply</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(epochs_results)), <span class="cf">function</span>(x){</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>    epochs_results[[x]]<span class="sc">$</span>spindles<span class="sc">$</span>epoch <span class="ot">=</span> x</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>    epochs_results[[x]]<span class="sc">$</span>spindles</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>}))</span></code></pre></div>
<p>Finally, plot the number of detected spindles by N2 epoch number
using <code>ggplot2</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="fu">ggplot</span>(spindles, <span class="fu">aes</span>(<span class="at">x =</span> epoch)) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;N2 epoch number&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Detected spindles&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="refs" class="references csl-bib-body">
<div id="ref-DeGennaro2003" class="csl-entry">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">L.
De Gennaro, M. Ferrara, Sleep spindles: An overview, Sleep Medicine
Reviews. 7 (2003) 423–440. https://doi.org/<a href="https://doi.org/10.1053/smrv.2002.0252">10.1053/smrv.2002.0252</a>.</div>
</div>
<div id="ref-Lacourse2019" class="csl-entry">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">K.
Lacourse, J. Delfrate, J. Beaudry, P. Peppard, S.C. Warby, A sleep
spindle detection algorithm that emulates human expert spindle scoring,
Journal of Neuroscience Methods. 316 (2019) 3–11. https://doi.org/<a href="https://doi.org/10.1016/j.jneumeth.2018.08.014">10.1016/j.jneumeth.2018.08.014</a>.</div>
</div>
<div id="ref-Kemp1992" class="csl-entry">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">B.
Kemp, A. Värri, A.C. Rosa, K.D. Nielsen, J. Gade, <span class="nocase">A
simple format for exchange of digitized polygraphic recordings</span>,
Electroencephalography and Clinical Neurophysiology. 82 (1992) 391–393.
https://doi.org/<a href="https://doi.org/10.1016/0013-4694(92)90009-7">10.1016/0013-4694(92)90009-7</a>.</div>
</div>
<div id="ref-niedermeyerElectroencephalographyBasicPrinciples2005" class="csl-entry">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">E.
Niedermeyer, F.H. Lopes da Silva, eds., Electroencephalography: Basic
principles, clinical applications, and related fields, 5th ed,
<span>Lippincott Williams &amp; Wilkins</span>,
<span>Philadelphia</span>, 2005.</div>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
