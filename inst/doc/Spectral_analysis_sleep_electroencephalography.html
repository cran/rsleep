<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Spectral Analysis of Sleep EEG Signals</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Spectral Analysis of Sleep EEG Signals</h1>


<div id="TOC">
<ul>
<li><a href="#sleep-data" id="toc-sleep-data">Sleep data</a></li>
<li><a href="#epoching" id="toc-epoching">Epoching</a></li>
<li><a href="#periodogram" id="toc-periodogram">Periodogram</a>
<ul>
<li><a href="#single-epoch" id="toc-single-epoch">Single epoch</a></li>
<li><a href="#stages-profiles" id="toc-stages-profiles">Stages
profiles</a></li>
</ul></li>
<li><a href="#bands" id="toc-bands">Bands</a></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
</div>

<p>This vignette provides a basic introduction to spectral analysis of
Electroencephalography (EEG) signal from a sleep record file.</p>
<p>EEG refers to all the methods of recording, analysis and
interpretation of the electrical activity of the brain. In clinical EEG,
multiple electrodes are usually placed on the scalp, measuring its
superficial activity over time. Electrodes are typically arranged using
the standardized International 10-20 system <span class="citation">[1]</span>, in order to enhance analysis
reproducibility.</p>
<p>EEG is a major component in sleep analysis. Sleep stages, such as
slow wave sleep or paradoxical sleep are partly defined over visual EEG
characteristics <span class="citation">[2]</span>. Many sleep related
disorders can be identified in EEG data. Polysomnography (PSG), the gold
standard exam in sleep medicine, includes EEG along many other
physiological signals <span class="citation">[3]</span>.</p>
<div id="sleep-data" class="section level2">
<h2>Sleep data</h2>
<p>Sleep records are usually stored using European Data Format (EDF)
<span class="citation">[4]</span>. The R package <a href="https://CRAN.R-project.org/package=edfReader"><code>edfReader</code></a>
reads <code>.edf</code> files. Reading an <code>.edf</code> file takes
two steps: First reading the headers of the file, then reading the
selected signals. The following spectral analysis will be performed on a
single channel of the EEG, the <code>C3-M2</code> central
derivation.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(edfReader)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">download.file</span>(</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  <span class="at">url =</span> <span class="st">&quot;https://rsleep.org/data/15012016HD.edf&quot;</span>,</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="at">destfile =</span> <span class="st">&quot;15012016HD.edf&quot;</span>,</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&#39;curl&#39;</span>)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">readEdfHeader</span>(<span class="st">&quot;15012016HD.edf&quot;</span>)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">readEdfSignals</span>(h, <span class="at">signals =</span> <span class="st">&quot;C3-M2&quot;</span>)</span></code></pre></div>
<p>The <code>rsleep</code> function <code>spectrogram()</code> plots the
spectrogram of the signal. But first, install <code>rsleep</code> latest
version from Github.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;boupetch/rsleep&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">library</span>(rsleep)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">spectrogram</span>(</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="at">signal =</span> s<span class="sc">$</span>signal,</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  <span class="at">sRate =</span> s<span class="sc">$</span>sRate,</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  <span class="at">startTime =</span> s<span class="sc">$</span>startTime)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><code>rsleep</code> reads this particular format with the
<code>read_events_noxturnal</code> function. The
<code>plot_hypnogram</code> function then plots the hypnogram.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">&quot;15012016HD.csv&quot;</span>)){</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="fu">download.file</span>(</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="at">url =</span> <span class="st">&quot;https://rsleep.org/data/15012016HD.csv&quot;</span>,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="at">destfile =</span> <span class="st">&quot;15012016HD.csv&quot;</span>)}</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>events <span class="ot">&lt;-</span> rsleep<span class="sc">::</span><span class="fu">read_events_noxturnal</span>(</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  <span class="st">&quot;15012016HD.csv&quot;</span>, h<span class="sc">$</span>startTime)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>rsleep<span class="sc">::</span><span class="fu">plot_hypnogram</span>(events)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The hypnogram show sleep stages over time using consecutive 30
seconds epochs. This record was manually scored by well-trained
technicians according to the American Academy of Sleep Medicine manual
<span class="citation">[2]</span>. Five sleep stages can be
observed:</p>
<ul>
<li><strong>AWA</strong>: Awakeness.</li>
<li><strong>REM</strong>: Rapid-Eye-Movement (REM) sleep, or paradoxical
sleep, highlighted in red.</li>
<li><strong>N1</strong>: Light sleep transitional stage.</li>
<li><strong>N2</strong>: Light sleep.</li>
<li><strong>N3</strong>: Slow-wave sleep.</li>
</ul>
<p>Visual scoring is an empirical science requiring a considerable
amount of knowledge and training. Alternative methods like spectral
estimations techniques such as the Fourier transform must be used to
quantify information carried in the physiological signals <span class="citation">[5]</span>.</p>
</div>
<div id="epoching" class="section level2">
<h2>Epoching</h2>
<p>Epoching is the first step of sleep analysis. Physiological signal,
such as EEG, is splitted into consecutive epochs of a discrete duration.
Epochs usually start at lights turnoff, when the patient or subject
starts the night.</p>
<p>As the example record already has a hynogram, the EEG signal can be
splitted using these scored epochs. The <code>epochs</code> function
from the <code>rsleep</code> package split the signal according to these
parameters. It returns a list of signal vectors.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>epochs <span class="ot">&lt;-</span> <span class="fu">epochs</span>(</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="at">signals =</span> s<span class="sc">$</span>signal,</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="at">sRates =</span> s<span class="sc">$</span>sRate,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="at">epoch =</span> events,</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="at">startTime =</span> <span class="fu">as.numeric</span>(<span class="fu">as.POSIXct</span>(h<span class="sc">$</span>startTime)))</span></code></pre></div>
</div>
<div id="periodogram" class="section level2">
<h2>Periodogram</h2>
<p>The Fourier transform (FT) may be the most important function in
signal analysis. It decomposes the signal into its constituent
frequencies and computes its power spectral densities (PSD). However,
EEG signals also carry a lot of noise. This noise is easily intereprted
by the FT and can jam the results. To solve this problem, Welch’s method
split the signal into overlapping segments to average power spectral
densities from the Fourier transform.</p>
<div id="single-epoch" class="section level3">
<h3>Single epoch</h3>
<p>The <code>pwelch</code> function <code>rsleep</code> computes a
periodogram using Welch’s method. The following example computes and
plot the periodogram of the 120th epoch. This epoch has been scored N2,
or light sleep, by the expert.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pwelch</span>(epochs[[<span class="dv">120</span>]], <span class="at">sRate =</span> s<span class="sc">$</span>sRate)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">summary</span>(p)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt;        hz           psd         </span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt;  Min.   :  0   Min.   :-12.007  </span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt;  1st Qu.: 25   1st Qu.:-11.132  </span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt;  Median : 50   Median :-10.343  </span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt;  Mean   : 50   Mean   : -9.128  </span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.: 75   3rd Qu.: -7.909  </span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt;  Max.   :100   Max.   :  0.000</span></span></code></pre></div>
<p>This epoch periodogram shows high PSD in lower frequencies of the
spectrum. As values are normalized using <code>log</code>, PSD are
negative.</p>
</div>
<div id="stages-profiles" class="section level3">
<h3>Stages profiles</h3>
<p>To compute average periodograms by stage, hypnogram and epochs can be
iterated simultaneously using the <code>mapply</code> function.
Periodograms can be filtered at this step to discard values over 30
Hertz.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>periodograms <span class="ot">&lt;-</span> <span class="fu">mapply</span>(</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="at">x =</span> epochs, </span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="at">y =</span> events<span class="sc">$</span>event,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="at">FUN =</span> <span class="cf">function</span>(x,y){</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">pwelch</span>(x, <span class="at">sRate =</span> s<span class="sc">$</span>sRate, <span class="at">show =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(p[p<span class="sc">$</span>hz <span class="sc">&lt;=</span> <span class="dv">30</span>,])</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>    p<span class="sc">$</span>stage <span class="ot">&lt;-</span> y</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>    p</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>}, <span class="at">SIMPLIFY =</span> F)</span></code></pre></div>
<p><code>mapply</code> returns a list that can be coerced to a
<code>dataframe</code> using <code>rbind</code> combined to
<code>do.call</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>periodograms_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">&quot;rbind&quot;</span>, periodograms)</span></code></pre></div>
<p>Once coerced to a <code>dataframe</code>, raw periodogram values can
be averaged by stage.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>avg_periodograms <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(psd <span class="sc">~</span> hz<span class="sc">+</span>stage, periodograms_df, mean)</span></code></pre></div>
<p>Aggregated periodograms can then be plotted using
<code>ggplot2</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">#&gt; Warning: package &#39;ggplot2&#39; was built under R version 4.2.3</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>palette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#5BBCD6&quot;</span>,<span class="st">&quot;#00A08A&quot;</span>,<span class="st">&quot;#F2AD00&quot;</span>,<span class="st">&quot;#F98400&quot;</span>,<span class="st">&quot;#FF0000&quot;</span>)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="fu">ggplot</span>(avg_periodograms, <span class="fu">aes</span>(<span class="at">x=</span>hz,<span class="at">y=</span>psd,<span class="at">color=</span>stage)) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">&quot;stage&quot;</span>,</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>                      <span class="at">values =</span> palette) <span class="sc">+</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Frequency (Hertz)&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;PSD&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Each sleep stage show a distinct average periodogram. If the
<code>N3</code> stage averages higher PSD values in the lower spectrum,
it show way lower PSD in the upper frequencies compared to other
stages.</p>
</div>
</div>
<div id="bands" class="section level2">
<h2>Bands</h2>
<p>The traditional way to simplify the EEG periodogram is to cut the
frequencies of the spectrum into bands or ranges <span class="citation">[1]</span>:</p>
<ul>
<li><p><strong>Delta</strong>: Below <code>3.5</code> Hertz, the Delta
band is associated with slow-wave sleep in adults subjects.</p></li>
<li><p><strong>Theta</strong>: Between <code>3.5</code> and
<code>7.5</code> Hertz, the Theta band is associated with drowsiness in
adults and teens subjects.</p></li>
<li><p><strong>Alpha</strong>: Between <code>7.5</code> and
<code>13</code> Hertz, the Alpha band is associated with a relaxed state
and eyes closed.</p></li>
<li><p><strong>Beta</strong>: Between <code>13</code> and
<code>30</code> Hertz the Beta band is associated with active thinking,
focus, high alert or anxiousness.</p></li>
<li><p><strong>Gamma</strong>: Over <code>30</code> Hertz the Gamma band
is mostly used for animal EEG analysis.</p></li>
</ul>
<p>Bands can be computed using the <code>bands_psd</code> of the
<code>rsleep</code> package. Those bands can be normalized by the
spectrum range covered by the bands.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>bands <span class="ot">&lt;-</span> <span class="fu">lapply</span>(epochs,<span class="cf">function</span>(x){</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>    <span class="fu">bands_psd</span>(</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>      <span class="at">bands =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">3.5</span>), <span class="co"># Delta</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>                   <span class="fu">c</span>(<span class="fl">3.5</span>,<span class="fl">7.5</span>), <span class="co"># Theta</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>                   <span class="fu">c</span>(<span class="fl">7.5</span>,<span class="dv">13</span>), <span class="co"># Alpha</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>                   <span class="fu">c</span>(<span class="dv">13</span>,<span class="dv">30</span>)), <span class="co"># Beta</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>      <span class="at">signal =</span> x, <span class="at">sRate =</span> s<span class="sc">$</span>sRate)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>})</span></code></pre></div>
<p>As <code>lapply</code> returns a list, results must be reshaped in
order to obtain a dataframe object.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>bands_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">unlist</span>(bands), <span class="at">nrow=</span><span class="fu">length</span>(bands), <span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="fu">colnames</span>(bands_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Delta&quot;</span>,<span class="st">&quot;Theta&quot;</span>,<span class="st">&quot;Alpha&quot;</span>,<span class="st">&quot;Beta&quot;</span>)</span></code></pre></div>
<p>Stages can be retreived from the hypnogram.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>bands_df<span class="sc">$</span>stage <span class="ot">&lt;-</span> rsleep<span class="sc">::</span><span class="fu">hypnogram</span>(events)<span class="sc">$</span>event</span></code></pre></div>
<p>Now that the epochs bands PSD and their corresponding stages are
stored in a dataframe, they can easily be plotted using boxplots from
<code>ggplot2</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>bands_df_long <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(bands_df, <span class="st">&quot;stage&quot;</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>palette <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;#F98400&quot;</span>, <span class="st">&quot;#F2AD00&quot;</span>, <span class="st">&quot;#00A08A&quot;</span>, <span class="st">&quot;#FF0000&quot;</span>, <span class="st">&quot;#5BBCD6&quot;</span>)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="fu">ggplot</span>(bands_df_long,</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>stage,<span class="at">y=</span>value,<span class="at">color=</span>stage)) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(variable),<span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">&quot;stage&quot;</span>,</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>                      <span class="at">values =</span> palette) <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;PSD&quot;</span>) <span class="sc">+</span> </span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body">
<div id="ref-niedermeyerElectroencephalographyBasicPrinciples2005" class="csl-entry">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">E.
Niedermeyer, F.H. Lopes da Silva, eds., Electroencephalography: Basic
principles, clinical applications, and related fields, 5th ed,
<span>Lippincott Williams &amp; Wilkins</span>,
<span>Philadelphia</span>, 2005.</div>
</div>
<div id="ref-AASMScoringManual" class="csl-entry">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline"><span>AASM Scoring Manual</span> -
<span>American Academy</span> of <span>Sleep Medicine</span>, American
Academy of Sleep Medicine Association for Sleep Clinicians and
Researchers. (n.d.).</div>
</div>
<div id="ref-ibanezSurveySleepAssessment2018" class="csl-entry">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">V.
Ibáñez, J. Silva, O. Cauli, A survey on sleep assessment methods, PeerJ.
6 (2018) e4849. https://doi.org/<a href="https://doi.org/10.7717/peerj.4849">10.7717/peerj.4849</a>.</div>
</div>
<div id="ref-Kemp1992" class="csl-entry">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">B.
Kemp, A. Värri, A.C. Rosa, K.D. Nielsen, J. Gade, <span class="nocase">A
simple format for exchange of digitized polygraphic recordings</span>,
Electroencephalography and Clinical Neurophysiology. 82 (1992) 391–393.
https://doi.org/<a href="https://doi.org/10.1016/0013-4694(92)90009-7">10.1016/0013-4694(92)90009-7</a>.</div>
</div>
<div id="ref-tongQuantitativeEEGAnalysis2009" class="csl-entry">
<div class="csl-left-margin">[5] </div><div class="csl-right-inline">S.
Tong, N.V. Thakor, eds., Quantitative <span>EEG</span> analysis methods
and clinical applications, <span>Artech House</span>,
<span>Boston</span>, 2009.</div>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
